<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>plibsys: pshmbuffer.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">plibsys
   &#160;<span id="projectnumber">0.0.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3a0b7d3a3e79d1c4236c98884ce82128.html">plibsys</a></li><li class="navelem"><a class="el" href="dir_23d65ea3503364d4c78c4aec4f946d15.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pshmbuffer.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Shared memory buffer.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="ptypes_8h_source.html">ptypes.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="pmacros_8h_source.html">pmacros.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="perror_8h_source.html">perror.h</a>&gt;</code><br />
</div>
<p><a href="pshmbuffer_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aeb254480a606d765f0503d2d303a6187"><td class="memItemLeft" align="right" valign="top">typedef struct PShmBuffer_&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a></td></tr>
<tr class="memdesc:aeb254480a606d765f0503d2d303a6187"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shared memory buffer opaque data structure.  <a href="#aeb254480a606d765f0503d2d303a6187">More...</a><br /></td></tr>
<tr class="separator:aeb254480a606d765f0503d2d303a6187"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9cdc1dec4bdb2ea8ee1bf0910d685b68"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pshmbuffer_8h.html#a9cdc1dec4bdb2ea8ee1bf0910d685b68">p_shm_buffer_new</a> (const <a class="el" href="ptypes_8h.html#a248e4ab1104e259e4c6cf5714551060e">pchar</a> *name, <a class="el" href="ptypes_8h.html#acf4b43938ddc5ed59f357c4892e79827">psize</a> size, <a class="el" href="perror_8h.html#a0ca29fda52d5b97f70f61234be28f1cd">PError</a> **error)</td></tr>
<tr class="memdesc:a9cdc1dec4bdb2ea8ee1bf0910d685b68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new <a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187" title="Shared memory buffer opaque data structure. ">PShmBuffer</a> structure.  <a href="#a9cdc1dec4bdb2ea8ee1bf0910d685b68">More...</a><br /></td></tr>
<tr class="separator:a9cdc1dec4bdb2ea8ee1bf0910d685b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeefd9870d2e77942861f93adec0dc203"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pshmbuffer_8h.html#aeefd9870d2e77942861f93adec0dc203">p_shm_buffer_free</a> (<a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *buf)</td></tr>
<tr class="memdesc:aeefd9870d2e77942861f93adec0dc203"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees <a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187" title="Shared memory buffer opaque data structure. ">PShmBuffer</a> structure.  <a href="#aeefd9870d2e77942861f93adec0dc203">More...</a><br /></td></tr>
<tr class="separator:aeefd9870d2e77942861f93adec0dc203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f24e476b6344d37a83197c6618e80cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pshmbuffer_8h.html#a8f24e476b6344d37a83197c6618e80cc">p_shm_buffer_take_ownership</a> (<a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *buf)</td></tr>
<tr class="memdesc:a8f24e476b6344d37a83197c6618e80cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes ownership of a shared memory buffer.  <a href="#a8f24e476b6344d37a83197c6618e80cc">More...</a><br /></td></tr>
<tr class="separator:a8f24e476b6344d37a83197c6618e80cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f42c8850e30e3abdaacb9b5aef2079f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="ptypes_8h.html#a9ec24ad7a25b7ff36c75d4e74d46b85f">pint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pshmbuffer_8h.html#a2f42c8850e30e3abdaacb9b5aef2079f">p_shm_buffer_read</a> (<a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *buf, <a class="el" href="ptypes_8h.html#a4395e523ec472129d35143032d004f22">ppointer</a> storage, <a class="el" href="ptypes_8h.html#acf4b43938ddc5ed59f357c4892e79827">psize</a> len, <a class="el" href="perror_8h.html#a0ca29fda52d5b97f70f61234be28f1cd">PError</a> **error)</td></tr>
<tr class="memdesc:a2f42c8850e30e3abdaacb9b5aef2079f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tries to read data from a shared memory buffer.  <a href="#a2f42c8850e30e3abdaacb9b5aef2079f">More...</a><br /></td></tr>
<tr class="separator:a2f42c8850e30e3abdaacb9b5aef2079f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6118a7872318bf2982f58d34d17475ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="ptypes_8h.html#a971496dd939ba601c1ba496468cef0e5">pssize</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pshmbuffer_8h.html#a6118a7872318bf2982f58d34d17475ea">p_shm_buffer_write</a> (<a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *buf, <a class="el" href="ptypes_8h.html#a4395e523ec472129d35143032d004f22">ppointer</a> data, <a class="el" href="ptypes_8h.html#acf4b43938ddc5ed59f357c4892e79827">psize</a> len, <a class="el" href="perror_8h.html#a0ca29fda52d5b97f70f61234be28f1cd">PError</a> **error)</td></tr>
<tr class="memdesc:a6118a7872318bf2982f58d34d17475ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tries to write data into a shared memory buffer.  <a href="#a6118a7872318bf2982f58d34d17475ea">More...</a><br /></td></tr>
<tr class="separator:a6118a7872318bf2982f58d34d17475ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70fb6039729eefe8d5c062968f1de839"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="ptypes_8h.html#a971496dd939ba601c1ba496468cef0e5">pssize</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pshmbuffer_8h.html#a70fb6039729eefe8d5c062968f1de839">p_shm_buffer_get_free_space</a> (<a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *buf, <a class="el" href="perror_8h.html#a0ca29fda52d5b97f70f61234be28f1cd">PError</a> **error)</td></tr>
<tr class="memdesc:a70fb6039729eefe8d5c062968f1de839"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets free space in the shared memory buffer.  <a href="#a70fb6039729eefe8d5c062968f1de839">More...</a><br /></td></tr>
<tr class="separator:a70fb6039729eefe8d5c062968f1de839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bfe82f2afed811d2c597a2eafac0419"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="ptypes_8h.html#a971496dd939ba601c1ba496468cef0e5">pssize</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pshmbuffer_8h.html#a0bfe82f2afed811d2c597a2eafac0419">p_shm_buffer_get_used_space</a> (<a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *buf, <a class="el" href="perror_8h.html#a0ca29fda52d5b97f70f61234be28f1cd">PError</a> **error)</td></tr>
<tr class="memdesc:a0bfe82f2afed811d2c597a2eafac0419"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets used space in the shared memory buffer.  <a href="#a0bfe82f2afed811d2c597a2eafac0419">More...</a><br /></td></tr>
<tr class="separator:a0bfe82f2afed811d2c597a2eafac0419"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2edd38e82890132e678d6191917a69f6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pshmbuffer_8h.html#a2edd38e82890132e678d6191917a69f6">p_shm_buffer_clear</a> (<a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *buf)</td></tr>
<tr class="memdesc:a2edd38e82890132e678d6191917a69f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears all data in the buffer and fills it with zeros.  <a href="#a2edd38e82890132e678d6191917a69f6">More...</a><br /></td></tr>
<tr class="separator:a2edd38e82890132e678d6191917a69f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Shared memory buffer. </p>
<dl class="section author"><dt>Author</dt><dd>Alexander Saprykin</dd></dl>
<p>A shared memory buffer works like any other buffer but it is built upon a shared memory region instead of the process-only address space. Thus it inherits all the advantages and disadvantages of shared memory behavior. You should read about <a class="el" href="pshm_8h.html#a242648937927f60bb00c5182324af26d" title="Shared memory opaque data structure. ">PShm</a> before using this buffer implementation to understand underlying restrictions.</p>
<p>The shared memory buffer is process-wide and identified by its name across the system, thus it can be opened by any process if it knows its name. Use <a class="el" href="pshmbuffer_8h.html#a9cdc1dec4bdb2ea8ee1bf0910d685b68" title="Creates a new PShmBuffer structure. ">p_shm_buffer_new()</a> to open the shared memory buffer and <a class="el" href="pshmbuffer_8h.html#aeefd9870d2e77942861f93adec0dc203" title="Frees PShmBuffer structure. ">p_shm_buffer_free()</a> to close it.</p>
<p>All read/write operations are completely thread- and process-safe, which means that no other synchronization primitive is required, even for inter- process access. A <a class="el" href="pshm_8h.html#a242648937927f60bb00c5182324af26d" title="Shared memory opaque data structure. ">PShm</a> locking mechanism is used for access synchronization.</p>
<p>The buffer is cyclic and non-overridable which means that you wouldn't get buffer overflow and wouldn't override previously written data until reading it.</p>
<p>The read operation checks whether there is any data available and reads it in case of successful check. After reading the data used space in the buffer is marked as free and any subsequent write operation may overwrite it. Thus you couldn't read the same data twice. The read operation is performed with the <a class="el" href="pshmbuffer_8h.html#a2f42c8850e30e3abdaacb9b5aef2079f" title="Tries to read data from a shared memory buffer. ">p_shm_buffer_read()</a> call.</p>
<p>The write operation checks whether there is enough free space available and writes a given memory block only if the buffer has enough free space. Otherwise no data is written. The write operation is performed with the <a class="el" href="pshmbuffer_8h.html#a6118a7872318bf2982f58d34d17475ea" title="Tries to write data into a shared memory buffer. ">p_shm_buffer_write()</a> call.</p>
<p>Data can be read and written into the buffer only sequentially. There is no way to access an arbitrary address inside the buffer.</p>
<p>You can take ownership of the shared memory buffer with <a class="el" href="pshmbuffer_8h.html#a8f24e476b6344d37a83197c6618e80cc" title="Takes ownership of a shared memory buffer. ">p_shm_buffer_take_ownership()</a> to explicitly remove it from the system after closing. Please refer to the <a class="el" href="pshm_8h.html#a242648937927f60bb00c5182324af26d" title="Shared memory opaque data structure. ">PShm</a> description to understand the intention of this action. </p>

<p class="definition">Definition in file <a class="el" href="pshmbuffer_8h_source.html">pshmbuffer.h</a>.</p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="aeb254480a606d765f0503d2d303a6187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb254480a606d765f0503d2d303a6187">&#9670;&nbsp;</a></span>PShmBuffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct PShmBuffer_ <a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shared memory buffer opaque data structure. </p>

<p class="definition">Definition at line <a class="el" href="pshmbuffer_8h_source.html#l00076">76</a> of file <a class="el" href="pshmbuffer_8h_source.html">pshmbuffer.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2edd38e82890132e678d6191917a69f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2edd38e82890132e678d6191917a69f6">&#9670;&nbsp;</a></span>p_shm_buffer_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> void p_shm_buffer_clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears all data in the buffer and fills it with zeros. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187" title="Shared memory buffer opaque data structure. ">PShmBuffer</a> to clear. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>0.0.1 </dd></dl>

</div>
</div>
<a id="aeefd9870d2e77942861f93adec0dc203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeefd9870d2e77942861f93adec0dc203">&#9670;&nbsp;</a></span>p_shm_buffer_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> void p_shm_buffer_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees <a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187" title="Shared memory buffer opaque data structure. ">PShmBuffer</a> structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187" title="Shared memory buffer opaque data structure. ">PShmBuffer</a> to free. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>0.0.1</dd></dl>
<p>Note that a buffer will be completely removed from the system only after the last instance of the buffer with the same name is closed. </p>

</div>
</div>
<a id="a70fb6039729eefe8d5c062968f1de839"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70fb6039729eefe8d5c062968f1de839">&#9670;&nbsp;</a></span>p_shm_buffer_get_free_space()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="ptypes_8h.html#a971496dd939ba601c1ba496468cef0e5">pssize</a> p_shm_buffer_get_free_space </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="perror_8h.html#a0ca29fda52d5b97f70f61234be28f1cd">PError</a> **&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets free space in the shared memory buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">buf</td><td><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187" title="Shared memory buffer opaque data structure. ">PShmBuffer</a> to check space in. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">error</td><td>Error report object, NULL to ignore. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Free space in bytes in case of success, -1 otherwise. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>0.0.1 </dd></dl>

</div>
</div>
<a id="a0bfe82f2afed811d2c597a2eafac0419"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bfe82f2afed811d2c597a2eafac0419">&#9670;&nbsp;</a></span>p_shm_buffer_get_used_space()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="ptypes_8h.html#a971496dd939ba601c1ba496468cef0e5">pssize</a> p_shm_buffer_get_used_space </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="perror_8h.html#a0ca29fda52d5b97f70f61234be28f1cd">PError</a> **&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets used space in the shared memory buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">buf</td><td><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187" title="Shared memory buffer opaque data structure. ">PShmBuffer</a> to check space in. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">error</td><td>Error report object, NULL to ignore. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Used space in bytes in case of success, -1 otherwise. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>0.0.1 </dd></dl>

</div>
</div>
<a id="a9cdc1dec4bdb2ea8ee1bf0910d685b68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cdc1dec4bdb2ea8ee1bf0910d685b68">&#9670;&nbsp;</a></span>p_shm_buffer_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a>* p_shm_buffer_new </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ptypes_8h.html#a248e4ab1104e259e4c6cf5714551060e">pchar</a> *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ptypes_8h.html#acf4b43938ddc5ed59f357c4892e79827">psize</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="perror_8h.html#a0ca29fda52d5b97f70f61234be28f1cd">PError</a> **&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new <a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187" title="Shared memory buffer opaque data structure. ">PShmBuffer</a> structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">name</td><td>Unique buffer name. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">size</td><td>Buffer size in bytes, can't be changed later. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">error</td><td>Error report object, NULL to ignore. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the <a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187" title="Shared memory buffer opaque data structure. ">PShmBuffer</a> structure in case of success, NULL otherwise. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>0.0.1</dd></dl>
<p>If a buffer with the same name already exists then the <em>size</em> will be ignored and the existing buffer will be returned. </p>

</div>
</div>
<a id="a2f42c8850e30e3abdaacb9b5aef2079f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f42c8850e30e3abdaacb9b5aef2079f">&#9670;&nbsp;</a></span>p_shm_buffer_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="ptypes_8h.html#a9ec24ad7a25b7ff36c75d4e74d46b85f">pint</a> p_shm_buffer_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ptypes_8h.html#a4395e523ec472129d35143032d004f22">ppointer</a>&#160;</td>
          <td class="paramname"><em>storage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ptypes_8h.html#acf4b43938ddc5ed59f357c4892e79827">psize</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="perror_8h.html#a0ca29fda52d5b97f70f61234be28f1cd">PError</a> **&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tries to read data from a shared memory buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">buf</td><td><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187" title="Shared memory buffer opaque data structure. ">PShmBuffer</a> to read data from. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">storage</td><td>Output buffer to put data in. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">len</td><td>Storage size in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">error</td><td>Error report object, NULL to ignore. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of read bytes (can be 0 if buffer is empty), or -1 if error occured. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>0.0.1 </dd></dl>

</div>
</div>
<a id="a8f24e476b6344d37a83197c6618e80cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f24e476b6344d37a83197c6618e80cc">&#9670;&nbsp;</a></span>p_shm_buffer_take_ownership()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> void p_shm_buffer_take_ownership </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes ownership of a shared memory buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>Shared memory buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>0.0.1</dd></dl>
<p>If you take ownership of the shared memory buffer, <a class="el" href="pshmbuffer_8h.html#aeefd9870d2e77942861f93adec0dc203" title="Frees PShmBuffer structure. ">p_shm_buffer_free()</a> will try to completely unlink it and remove from the system. This is useful on UNIX systems, where shared memory can survive an application crash. On the Windows and OS/2 platforms this call has no effect.</p>
<p>The common usage of this call is upon application startup to ensure that the memory segment from the previous crash can be removed from the system. To do that, call <a class="el" href="pshmbuffer_8h.html#a9cdc1dec4bdb2ea8ee1bf0910d685b68" title="Creates a new PShmBuffer structure. ">p_shm_buffer_new()</a> and check if its condition is normal (used space, free space). If not, take ownership of the shared memory buffer object and remove it with the <a class="el" href="pshmbuffer_8h.html#aeefd9870d2e77942861f93adec0dc203" title="Frees PShmBuffer structure. ">p_shm_buffer_free()</a> call. After that, create it again. </p>

</div>
</div>
<a id="a6118a7872318bf2982f58d34d17475ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6118a7872318bf2982f58d34d17475ea">&#9670;&nbsp;</a></span>p_shm_buffer_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="ptypes_8h.html#a971496dd939ba601c1ba496468cef0e5">pssize</a> p_shm_buffer_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187">PShmBuffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ptypes_8h.html#a4395e523ec472129d35143032d004f22">ppointer</a>&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ptypes_8h.html#acf4b43938ddc5ed59f357c4892e79827">psize</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="perror_8h.html#a0ca29fda52d5b97f70f61234be28f1cd">PError</a> **&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tries to write data into a shared memory buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">buf</td><td><a class="el" href="pshmbuffer_8h.html#aeb254480a606d765f0503d2d303a6187" title="Shared memory buffer opaque data structure. ">PShmBuffer</a> to write data into. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">data</td><td>Data to write. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">len</td><td>Data size in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">error</td><td>Error report object, NULL to ignore. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of written bytes (can be 0 if buffer is full), or -1 if error occured. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>0.0.1 </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Write operation is performed only if the buffer has enough space for the given data size. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
