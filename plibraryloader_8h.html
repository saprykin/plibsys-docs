<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>plibsys: plibraryloader.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">plibsys<span id="projectnumber">&#160;0.0.5</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3a0b7d3a3e79d1c4236c98884ce82128.html">plibsys</a></li><li class="navelem"><a class="el" href="dir_23d65ea3503364d4c78c4aec4f946d15.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">plibraryloader.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Shared library loader.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="pmacros_8h_source.html">pmacros.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="ptypes_8h_source.html">ptypes.h</a>&gt;</code><br />
</div>
<p><a href="plibraryloader_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a61615e8306b787ee90199d0736c519f2" id="r_a61615e8306b787ee90199d0736c519f2"><td class="memItemLeft" align="right" valign="top">typedef struct PLibraryLoader_&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a61615e8306b787ee90199d0736c519f2">PLibraryLoader</a></td></tr>
<tr class="memdesc:a61615e8306b787ee90199d0736c519f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opaque data structure to handle a shared library.  <br /></td></tr>
<tr class="separator:a61615e8306b787ee90199d0736c519f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d4245b58d8dc5075c23706f24db72b5" id="r_a1d4245b58d8dc5075c23706f24db72b5"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1d4245b58d8dc5075c23706f24db72b5">PFuncAddr</a>) (void)</td></tr>
<tr class="memdesc:a1d4245b58d8dc5075c23706f24db72b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to a function address.  <br /></td></tr>
<tr class="separator:a1d4245b58d8dc5075c23706f24db72b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3ff45cc7f690548bc707b5a83d497887" id="r_a3ff45cc7f690548bc707b5a83d497887"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="#a61615e8306b787ee90199d0736c519f2">PLibraryLoader</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3ff45cc7f690548bc707b5a83d497887">p_library_loader_new</a> (const <a class="el" href="ptypes_8h.html#a248e4ab1104e259e4c6cf5714551060e">pchar</a> *path)</td></tr>
<tr class="memdesc:a3ff45cc7f690548bc707b5a83d497887"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads a shared library.  <br /></td></tr>
<tr class="separator:a3ff45cc7f690548bc707b5a83d497887"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a1310dab5373832fb00b46b692fcdac" id="r_a1a1310dab5373832fb00b46b692fcdac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="#a1d4245b58d8dc5075c23706f24db72b5">PFuncAddr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a1310dab5373832fb00b46b692fcdac">p_library_loader_get_symbol</a> (<a class="el" href="#a61615e8306b787ee90199d0736c519f2">PLibraryLoader</a> *loader, const <a class="el" href="ptypes_8h.html#a248e4ab1104e259e4c6cf5714551060e">pchar</a> *sym)</td></tr>
<tr class="memdesc:a1a1310dab5373832fb00b46b692fcdac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a pointer to a symbol in the loaded shared library.  <br /></td></tr>
<tr class="separator:a1a1310dab5373832fb00b46b692fcdac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2be8012444578e8348964f419b64555d" id="r_a2be8012444578e8348964f419b64555d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2be8012444578e8348964f419b64555d">p_library_loader_free</a> (<a class="el" href="#a61615e8306b787ee90199d0736c519f2">PLibraryLoader</a> *loader)</td></tr>
<tr class="memdesc:a2be8012444578e8348964f419b64555d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees memory and allocated resources of <a class="el" href="#a61615e8306b787ee90199d0736c519f2" title="Opaque data structure to handle a shared library.">PLibraryLoader</a>.  <br /></td></tr>
<tr class="separator:a2be8012444578e8348964f419b64555d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbdcd58cff766d4682622139fc2dd55c" id="r_acbdcd58cff766d4682622139fc2dd55c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="ptypes_8h.html#a248e4ab1104e259e4c6cf5714551060e">pchar</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acbdcd58cff766d4682622139fc2dd55c">p_library_loader_get_last_error</a> (<a class="el" href="#a61615e8306b787ee90199d0736c519f2">PLibraryLoader</a> *loader)</td></tr>
<tr class="memdesc:acbdcd58cff766d4682622139fc2dd55c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the last occurred error.  <br /></td></tr>
<tr class="separator:acbdcd58cff766d4682622139fc2dd55c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a343c6b553b597741a53b332e6852bb92" id="r_a343c6b553b597741a53b332e6852bb92"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="ptypes_8h.html#af5cb791e13f977b94e0192f84a5f228b">pboolean</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a343c6b553b597741a53b332e6852bb92">p_library_loader_is_ref_counted</a> (void)</td></tr>
<tr class="memdesc:a343c6b553b597741a53b332e6852bb92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether library loading subsystem uses reference counting.  <br /></td></tr>
<tr class="separator:a343c6b553b597741a53b332e6852bb92"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Shared library loader. </p>
<dl class="section author"><dt>Author</dt><dd>Alexander Saprykin</dd></dl>
<p>All modern operating systems support dynamic loadable objects. Such objects are compiled with special flags and can be loaded by other programs and libraries later at the runtime. These loadable objects often called as the shared libraries, though some platforms even allow to treat the program binary as a loadable object, too.</p>
<p>When the program is linked with a shared library its dependency would be resolved by the operating system automatically before starting the program. But in some circumstances you may need to load a shared library object explicitly (i.e. implementing a plugin subsystem, checking for API availability).</p>
<p>All functions and variables which a shared library is exporting are called symbols. Usually only the exported symbols are available from outside the shared library. Actually all those symbols represent a library API.</p>
<p>Use <a class="el" href="#a3ff45cc7f690548bc707b5a83d497887" title="Loads a shared library.">p_library_loader_new()</a> to load a shared library and <a class="el" href="#a1a1310dab5373832fb00b46b692fcdac" title="Gets a pointer to a symbol in the loaded shared library.">p_library_loader_get_symbol()</a> to retrieve a pointer to a symbol within it. Close the library after usage with <a class="el" href="#a2be8012444578e8348964f419b64555d" title="Frees memory and allocated resources of PLibraryLoader.">p_library_loader_free()</a>.</p>
<p>Please note the following platform specific differences:</p>
<ul>
<li>HP-UX doesn't support loading libraries containing TLS and built with static TLS model. The same rule applies to any library used as dependency. HP-UX on 32-bit PA-RISC systems doesn't support reference counting for loaded libraries when using shl_* family of functions (always removes all library references on unload).</li>
<li>On OpenVMS only shareable images (linked with /SHAREABLE) can be used for dynamic symbol resolving. Usually they have .EXE extension.</li>
<li>BeOS supports dynamic loading for add-ons only. It is also possible to load the same library several times independently (not like a traditional shared library). </li>
</ul>

<p class="definition">Definition in file <a class="el" href="plibraryloader_8h_source.html">plibraryloader.h</a>.</p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="a1d4245b58d8dc5075c23706f24db72b5" name="a1d4245b58d8dc5075c23706f24db72b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d4245b58d8dc5075c23706f24db72b5">&#9670;&#160;</a></span>PFuncAddr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* PFuncAddr) (void)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pointer to a function address. </p>

<p class="definition">Definition at line <a class="el" href="plibraryloader_8h_source.html#l00083">83</a> of file <a class="el" href="plibraryloader_8h_source.html">plibraryloader.h</a>.</p>

</div>
</div>
<a id="a61615e8306b787ee90199d0736c519f2" name="a61615e8306b787ee90199d0736c519f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61615e8306b787ee90199d0736c519f2">&#9670;&#160;</a></span>PLibraryLoader</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct PLibraryLoader_ <a class="el" href="#a61615e8306b787ee90199d0736c519f2">PLibraryLoader</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opaque data structure to handle a shared library. </p>

<p class="definition">Definition at line <a class="el" href="plibraryloader_8h_source.html#l00080">80</a> of file <a class="el" href="plibraryloader_8h_source.html">plibraryloader.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2be8012444578e8348964f419b64555d" name="a2be8012444578e8348964f419b64555d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2be8012444578e8348964f419b64555d">&#9670;&#160;</a></span>p_library_loader_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> void p_library_loader_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#a61615e8306b787ee90199d0736c519f2">PLibraryLoader</a> *</td>          <td class="paramname"><span class="paramname"><em>loader</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees memory and allocated resources of <a class="el" href="#a61615e8306b787ee90199d0736c519f2" title="Opaque data structure to handle a shared library.">PLibraryLoader</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">loader</td><td><a class="el" href="#a61615e8306b787ee90199d0736c519f2" title="Opaque data structure to handle a shared library.">PLibraryLoader</a> object to free. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>0.0.1 </dd></dl>

</div>
</div>
<a id="acbdcd58cff766d4682622139fc2dd55c" name="acbdcd58cff766d4682622139fc2dd55c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbdcd58cff766d4682622139fc2dd55c">&#9670;&#160;</a></span>p_library_loader_get_last_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="ptypes_8h.html#a248e4ab1104e259e4c6cf5714551060e">pchar</a> * p_library_loader_get_last_error </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#a61615e8306b787ee90199d0736c519f2">PLibraryLoader</a> *</td>          <td class="paramname"><span class="paramname"><em>loader</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the last occurred error. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">loader</td><td><a class="el" href="#a61615e8306b787ee90199d0736c519f2" title="Opaque data structure to handle a shared library.">PLibraryLoader</a> object to get error for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Human readable error string in case of success, NULL otherwise. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>0.0.1 </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.0.3 <code>loader</code> parameter was added. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Caller takes ownership of the returned string.</dd></dl>
<p>The NULL result may indicate that no error was occurred since the last call.</p>
<p>Different operating systems have different behavior on error indicating. Some systems reset an error status before the call, some do not. Some systems write the successful call result (usually zero) to the error status, thus resetting an error from the previous call.</p>
<p>Some operating systems may return last error even if library handler was not created. In that case try to pass NULL value as a parameter. </p>

</div>
</div>
<a id="a1a1310dab5373832fb00b46b692fcdac" name="a1a1310dab5373832fb00b46b692fcdac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a1310dab5373832fb00b46b692fcdac">&#9670;&#160;</a></span>p_library_loader_get_symbol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="#a1d4245b58d8dc5075c23706f24db72b5">PFuncAddr</a> p_library_loader_get_symbol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#a61615e8306b787ee90199d0736c519f2">PLibraryLoader</a> *</td>          <td class="paramname"><span class="paramname"><em>loader</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="ptypes_8h.html#a248e4ab1104e259e4c6cf5714551060e">pchar</a> *</td>          <td class="paramname"><span class="paramname"><em>sym</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a pointer to a symbol in the loaded shared library. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">loader</td><td>Pointer to the loaded shared library handle. </td></tr>
    <tr><td class="paramname">sym</td><td>Name of the symbol. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the symbol in case of success, NULL otherwise. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>0.0.1</dd></dl>
<p>Since the symbol may have a NULL value, the returned NULL value from this call actually doesn't mean the failed result. You can additionally check the error result using <a class="el" href="#acbdcd58cff766d4682622139fc2dd55c" title="Gets the last occurred error.">p_library_loader_get_last_error()</a>. </p>

</div>
</div>
<a id="a343c6b553b597741a53b332e6852bb92" name="a343c6b553b597741a53b332e6852bb92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a343c6b553b597741a53b332e6852bb92">&#9670;&#160;</a></span>p_library_loader_is_ref_counted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="ptypes_8h.html#af5cb791e13f977b94e0192f84a5f228b">pboolean</a> p_library_loader_is_ref_counted </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks whether library loading subsystem uses reference counting. </p>
<dl class="section return"><dt>Returns</dt><dd>TRUE in case of success, FALSE otherwise. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>0.0.3</dd></dl>
<p>When reference counting is supported, the same shared library can be opened several times, but it would be completely unloaded from the memory only when the last reference to it is removed.</p>
<dl class="section note"><dt>Note</dt><dd>For now, only HP-UX on 32-bit PA-RISC systems with shl_* model doesn't support reference counting. </dd></dl>

</div>
</div>
<a id="a3ff45cc7f690548bc707b5a83d497887" name="a3ff45cc7f690548bc707b5a83d497887"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ff45cc7f690548bc707b5a83d497887">&#9670;&#160;</a></span>p_library_loader_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pmacros_8h.html#afc4a56cf925c0c90d086f3480ffc257c">P_LIB_API</a> <a class="el" href="#a61615e8306b787ee90199d0736c519f2">PLibraryLoader</a> * p_library_loader_new </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ptypes_8h.html#a248e4ab1104e259e4c6cf5714551060e">pchar</a> *</td>          <td class="paramname"><span class="paramname"><em>path</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads a shared library. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>Path to the shared library file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to <a class="el" href="#a61615e8306b787ee90199d0736c519f2" title="Opaque data structure to handle a shared library.">PLibraryLoader</a> in case of success, NULL otherwise. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>0.0.1</dd></dl>
<p>If you are loading the already loaded shared library, an operating system increments corresponding reference count and decrements it after freeing <a class="el" href="#a61615e8306b787ee90199d0736c519f2" title="Opaque data structure to handle a shared library.">PLibraryLoader</a>, thus the shared library would be unloaded from the address space only when the counter becomes zero. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
